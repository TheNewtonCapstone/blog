---
title: "Electric And Electronic Systems"
date: 2024-11-26
categories: [ELEC]
tags: [circuits, motors, drivers]     # TAG names should always be lowercase
author: [ca]
---

# Electric And Electronic System

## Introduction
For Newton's electrical and electronic systems, the objective is to make the system as simple as possible: using off-the-shelf and cheap parts, allowing for users to adapt their system to what they can find, and therefore adapting the low-level scripts.


## High Level Circuit Diagram

![image](/assets/img/blog5/circuit.png)

## Circuit Elements

![image](/assets/img/blog5/motor.png)

### Motors
The motors we tested were the Tarot 5008/340KV Brushless Motor/black(TL96020), ordered from Foxtech FPV for around 50 USD a piece, and the Mitoot 5010 360KV / 750KV High Torque Brushless Motors from AliExpress for 44 USD a piece. <br><br>
After testing however, we decided that the force generated by the cheaper motor was not good enough for our robot, and that the price difference was small enough to justify choosing the more expensive motor. We therefore chose the Tarot motor.

 
![image](/assets/img/blog5/encoder.png)

### Encoder
We chose the AMT103-V encoder from Same Sky, ordered from Digikey for 41 CAD per piece, as it is reliable for a small size, is reasonably priced, and is extremely precise, which is a requirement for the _sim2real_ part of the project. 


### Microcontroller
For the Microcontroller, we chose an ESP32 board, which is the perfect solution for us, as it is a low cost, low voltage solution with a very high processing speed, at 240MHz with two cores, which is a requirement for reading from the encoders that we selected. At the same time, the easy-to-use communication protocols would allow communication with the Jetson Nano. The large user-base and number of libraries also allows for ease of use for everyone, and the interface is only a small step above that of an arduino.<br><br>
However, the number of motors (12) and of connected encoders, each element requiring the use of 2 pins to communicate with, shows one drawback of using the ESP32, which is the fact that it only has 27 GPIO pins, of which 2 at least will be used to communicate with the Jetson Nano, which leaves only 25 pins, which would only be enough for half of the robot. To mitigate this problem, we may, in the future, either use two ESP32s in parallel, or purchase a pin extender.

### Motor Controllers
For motor controllers, we tested 5 different Electronic Speed Controllers. Below we can see a decision matrix for each of these speed controllers.

 ESC                              | Price | Pros                                       | Cons                                                                             | Image |
|----------------------------------|-------|--------------------------------------------|----------------------------------------------------------------------------------|-------|
| RioRand 300W 5-50V PWM           | 24.99 | Cheap <br/> Accessible <br/> Ease of use               | Low Documentation <br/> Low Quality <br/> 5v                                                 | ![image](/assets/img/blog5/riorand_no_hall.png) |
| RioRand 350W 6-60V PWM with Hall | 24.99 | Cheap <br/> Accessible <br/> Ease of use               | Low Documentation <br/> Low Quality <br/> Hall Sensor <br/> 5v                                     | ![image](/assets/img/blog5/riorand_hall.png) |
| Alomejor 30A Brushless ESC RC    | 18.80 | Cheapest <br/> Accessible <br/> Ease of use            | No Documentation <br/> Low Quality <br/> Not made for our applications <br/> 5v                    | ![image](/assets/img/blog5/esc.png) |
| STMicroelectronics B-G431B-ESC1  | 30.06 | High quality <br/> Reliable <br/> Large Documentation | Complex <br/> Slightly <br/> Expensive <br/> Need for very precise soldering <br/> Hall Sensor option <br/> 5v | ![image](/assets/img/blog5/high_cost_controller.png) |
| EVTSCAN 12V to 36V DC 15A 500W   | 23.99 | Cheap <br/> Accessible                           | No Documentation <br/> Low Quality <br/> Hall Sensor <br/> 5v                                      | ![image](/assets/img/blog5/amazon_controller.png) |

For the Hall sensors, we realized that for most drivers this was a requirement, and that our encoders did not generate the right outputs for these sensors, therefore these could not be used. <br><br>
We therefore chose the RioRand 300W 5-50V PWM for its ease of use and ease of access, as almost anyone could buy this product from Amazon. <br><br>
After testing, we also realized a minor problem, which is that the direction pin of the RioRand driver does not switch the motor direction when the pin is given a low signal, it only switches when the pin is pull towards ground, which most usual microcontrollers cannot do. We therefore had to create a quick transistor switching circuit, which would allow for the quick and easy programming of the motor directions. 

![image](/assets/img/blog5/logic_level_shifter.png)

### Logic Level Controller
We realized after confirming our decision for microcontroller and motor driver, that the RioRand 300W 5-50V PWM requires a 5v control signal, which the ESP32 cannot provide, as it can only output 3.3V. Therefore, our circuit requires a logic level converter, or shifter. We selected the SparkFun Bi-Directional Logic Level Converter, which easily allows the conversion of our signals to the corresponding voltage.

### Battery
For the mechanical requirements needed from the motor, they need to receive at least 22V. We therefore chose to use either a 6S LiPo (Lithium Polymer), or 2 3S LiPos in series. LiPo batteries were chosen as they have a high energy density, and a high discharge rate, which is perfect for robotics, and more specifically, the Newton Dog.

### Voltage Converter
At the same time as powering the motors, we also need a lower voltage to power the boards, which for all the chosen boards is 5V. We therefore are using the LM2596 DC to DC High Efficiency Voltage Regulator, randomly ordered from Amazon, as they are extremely cheap and respond to our needs, as they provide a reliable enough voltage and adapt to almost any voltage input or output needs.
